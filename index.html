<!DOCTYPE html>
<html>
<head>
    <title>Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map { height: 100vh; }
    </style>
</head>
<body>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Initialize the map
        var map = L.map('map').setView([0, 0], 2); // Set initial view to [0, 0] and zoom level 2

        // Add OpenStreetMap tile layer to the map
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
        }).addTo(map);

        // Fetch the data from the API
        fetch('https://api.npoint.io/f26432e9e880999eeb1b')
            .then(response => response.json())
            .then(data => {
                // Loop through the data
                for (let building of data) {
                    // Create a marker for each building
                    var marker = L.marker([building.lat, building.lng]);

                    // Check if there are any nearby markers
                    var nearbyMarkers = data.filter(b => {
                        return b !== building && getDistance(b, building) < 0.01; // Change this value to adjust the "nearby" distance
                    });

                    // If there are nearby markers, set the color to red
                    if (nearbyMarkers.length > 0) {
                        marker.setIcon(L.icon({
                            iconUrl: 'path/to/red/marker.png', // Replace with the path to your red marker image
                            iconSize: [25, 41],
                            iconAnchor: [12, 41],
                        }));
                    }

                    // Add the marker to the map
                    marker.addTo(map);
                }
            });

        // Function to get the distance between two points
        function getDistance(a, b) {
            var lat1 = a.lat;
            var lon1 = a.lng;
            var lat2 = b.lat;
            var lon2 = b.lng;

            var R = 6371; // Radius of the earth in km
            var dLat = deg2rad(lat2-lat1);
            var dLon = deg2rad(lon2-lon1); 
            var a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * 
                Math.sin(dLon/2) * Math.sin(dLon/2)
                ; 
            var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
            var d = R * c; // Distance in km
            return d;
        }

        function deg2rad(deg) {
            return deg * (Math.PI/180)
        }
    </script>
</body>
</html>